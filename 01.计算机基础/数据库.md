# 数据库原理

## 题型

- 单选题：15 * 2 = 30
- 填空题：10 * 1 = 10
- 文字题：5 * 6 = 30
- 综合题：2 * 15 =30

> 考试时间：150 分钟



## 一、数据库系统概述

### 1. 数据库基本概念

##### 数据（Data）

是描述事物的**符号记录**，是指利用物理符号记录下来的、可以鉴别的信息。数据是**信息**存在的一种形式，只有通过**解释**或**处理**的数据才能成为有用的信息。



##### 数据库（Database, DB）

是指**长期储存**在计算机中的**有组织**的、**可共享**的数据集合。

数据要按照一定的**数据模型组织、描述和存储**，具有较小的**冗余度**、较高的**数据独立性**，系统易于**扩展**，并可以被多个用户**分享**。



##### 数据库管理系统（DBMS）

是专门用于**建立**和**管理**数据库的一套软件，介于**应用程序**和**操作系统**之间。



**数据库管理系统及其功能**

- 数据定义功能
- 数据操纵功能

- 数据库的运行管理功能

- 数据库的建立和维护功能

- 数据组织、存储和管理功能

- 其他功能



##### 数据库系统（DBS）

一个完整的数据库系统包括：

- 数据库（DB）
- 数据库管理系统（DBMS）
- 数据库管理员（DBA）
- 应用程序 
- 用户



### 2. 数据库管理技术的发展

三个发展阶段：

1. **人工管理阶段**：数据不保存、应用程序管理数据、数据面向应用

2. **文件系统阶段**：数据可长期存储；不能实现数据普通共享，只能文件级的共享、数据冗余
3. **数据库系统阶段**，全是优点：

- **数据集成**（主要目的）
- 数据共享性高
- 数据冗余小
- 数据一致性
- 数据独立性高
- 实施统一管理与控制：主要包括数据的独立性、完整性、并发控制与故障恢复等，即数据库保护
- 减少应用程序开发与维护的工作量



### 3. 数据库系统的结构

##### 3.1 数据库系统的结构分类

![image-20220720102245109](https://cdn.jsdelivr.net/gh/abeelan/image-hosting-service/img/image-20220720102245109.png)



##### 3.2 三级模式结构

<img src="https://cdn.jsdelivr.net/gh/abeelan/image-hosting-service/img/image-20220720102617422.png" alt="image-20220720102617422" style="zoom: 33%;" />

**模式（核心）**：**概念**模式、逻辑模式；概念视图

**外模式**：子模式、**用户**模式；数据视图，即用户视图

**内模式**：**存储**模式、物理模式；内部视图或存储视图



三级模式结构的两层映像与数据独立性

**映像**就是一种**对应规则**，两层映像：

- 模式/内模式映像：保证了数据与程序的**物理独立性**
- 外模式/模式映像：保证了数据与程序的**逻辑独立性**



##### 3.3 客户/服务器结构

- 表示层：客户端、前台；主要完成与数据库使用者的交互任务
- 数据层：服务器、后台；主要负责数据管理

分为两种工作方式：单机方式、网络方式。



##### 3.4 浏览器/服务器结构

是一种基于 web 应用的客户/服务器结构，也称为**三层**客户/服务器结构。

- **表示层**：UI
- **处理层**：中间层
- **数据层**



### 4. 数据模型

模型是现实世界特征的模拟和抽象表达。

**数据模型**是对现实世界数据特征的抽象，描述的是数据的**共性内容**。

**数据模型**是模型化数据和信息的工具，也是数据库系统的**核心和基础**。

数据模型需满足三点：

- 比较真实的模拟现实世界
- 容易为人们理解
- 便于在计算机上实现



##### 数据模型的特征

**静态特征**：数据的基本结构、数据间的联系、数据取值范围的约束

**动态特征**：指对数据可以进行符合一定规则的操作



##### 数据模型组成的三大要素

**数据结构**：描述的是系统的**静态特征**，即数据对象的**数据类型、内容、属性**以及数据对象之间的**联系**。

**数据操作**：描述的是系统的**动态**特征。

**数据约束**：描述数据结构中数据间的**语法和语义关联**。



##### 数据模型的分类

- **概念模型**（现实世界抽象为信息世界）**概念层**数据抽象级别的**最高层**。也称为**信息模型**，主要用于数据库的**设计阶段**；

- **逻辑模型**（信息世界转化为机器世界）**逻辑层**是数据抽象级别的**中间层**。任何 DBMS 都是基于某种**逻辑数据模型**；

- **物理模型**（机器世界）物理层描述数据在存储介质上的组织结构，是**逻辑模型**的物理实现，是数据库**最底层**的抽象，设计目标是提高数据库性能和有效利用存储空间。



##### 概念模型

信息世界涉及的基本概念：

- 实体（Entity）：具体的项目、职工等
- 属性（Attribute）：姓名、性别等
- 码或键（Key）：唯一标识
- 域（Domain）：属性的取值范围
- 实体型（Entity Type）：实体+属性
- 实体集（Tntity Set）：同类型实体
- 联系（Relationship）：实体之间的关系



数据模型中有**“型”（type）**和**“值”（value）**两个概念。



概念模型的表示方法（E-R 图）

- 长方形表示**实体型**
- 椭圆表示**属性**
- 菱形表示**联系**



##### 逻辑模型的类型

层次模型：（层次数据库）**最早使用**，有且仅有一个结点没有**父结点**，称作**根节点**，其他结点有且仅有一个**父结点**

网状模型：（网状数据库）以**网状结构**表示实体与实体间的联系，允许结点有多于一个父结点，允许无父结点

**关系模型**：（关系数据库）用**二维表结构**表示实体间的联系。建立在严格的**数学概念**的基础上、概念单一、存取路径对用户透明，有更高的数据独立性，更好的安全保密性

面向对象模型：即使**概念模型**又是逻辑模型，表达能力丰富，对象可复用、维护方便



## 二、关系数据库

### 1. 关系数据模型

组成要素：

- **关系数据结构**

- **关系操作集合**
- **关系完整性约束**



##### 1.1 关系数据结构

**表（Table）**也称为关系，由表名、列、若干行数据组成，表名必须唯一；

关系的三种类型：

- 基本关系：基本表、基表，实际存在的表
- 查询表：虚表
- 视图表：虚表



**列（Column）**也称为**字段（Field）**或**属性（Attribute）**，同一列数据类型相同。字段名必须唯一，不同表中可以出现相同的字段名。

属性的个数称为关系的**元**或**度**，列的值称为**属性值**，其取值范围称为**值域**。



**行（Row）**也称为**元组（Tuple）**或**记录（Record）**，表中的数据按行存储。

元组（行）中的一个属性值，称为**分量（Component）**。



**码或键（Key）**：属性（或属性组）的值都能用来**唯一标识**该关系的元组，则称这些属性（或属性组）为该关系的码或键。



**超码或超键（Super Key）**：在码中去除某个属性，它仍然是这个关系的码。



**候选码或候选键（Candidate Key）**：在码中不能从中移去任何一个属性，否则它就不再是这个关系的码或键。候选码或候选键是这个关系的**最小**超码或超键。



**主属性（Primary Attribure）或非主属性（Nonprimary Attribute）**：包含在任何一个候选码中的属性称为称为主属性或码属性。



**主码或主键（Primary Key）**：在若干个候选码中**指定**一个**唯一标识**关系的元组（行）。由主观意愿指定。



**全码或全键（All Key）**：一个关系模式的所有属性集合是这个关系的主码或主键。



**外码或外键（Foreign Key）**：某个属性（或属性组）不是这个关系的主码或候选码，而是另一个关系的主码。



**参照关系（Referencing Relation）和被参照关系（Referenced Relation）**：参照关系也称为从关系，被参照关系也称为主关系，他们是指以外码相关联的两个关系。



**域（Domain）**：表示属性的取值范围。



![image-20220722160211177](https://cdn.jsdelivr.net/gh/abeelan/image-hosting-service/img/image-20220722160211177.png)



**数据类型（Data Type）**：每个列都有相应的数据类型，它用于限制（或容许）该列中存储的数据。



**关系模式（Relation Scheme）**：表头，关系模式是型（Type），关系是值（Value），关系模式是对关系的描述。关系模式是静态的、稳定的，关系是动态的、随时间不断变化的。



**关系数据库（Relation Database）**：所有关系的集合，构成一个关系数据库。以关系模型作为数据的逻辑模型，并采用关系作为数据组织方式的一类数据库，其数据库操作建立在关系代数的基础上。



关系数据库对关系的限定/要求：

1. 每一个属性都是不可分解的（不允许表中有表）；
2. 每一个关系仅仅有一种关系模式；
3. 每一个关系模式中的属性必须命名，属性名不同；
4. 同一个关系中不允许出现候选码或候选键**值**完全相同的元组；
5. 在关系中元组的顺序（行序）是无关紧要的，可以任意交换；
6. 在关系中属性的顺序（列序）是无关紧要的，可以任意交换。



##### 1.2 基本的关系操作

- **查询（Query）**
- 插入（Insert）：更新操作
- 删除（Delete）：更新操作
- 修改（Update）：更新操作



关系数据语言的分类：

- 关系代数语言
- 结构化查询语言（SQL）

- 关系演算语言



关系代数的运算符，任何一种操作都包含三大要素：操作对象、操作符、操作结果。



**传统的集合运算**：并、差、交、笛卡尔积

- 并（UNION）：度和属性都相同的数据会合并（两个关系必须有相同的属性个数）；
- 差（DIFFRENCE）：以左侧为基础，减去共同拥有的部分（两个关系必须有相同的属性个数）；
- 交（INTERSECTION）：求出两个关系的公共部分（两个关系必须有相同的属性个数）；
- 笛卡尔积（CARTESIAN PRODUCT）：两关系元组个数相乘为结果元组个数，结果属性个数为两关系属性之和。



**专门的关系运算**：选择、投影、连接、除

- 选择（SELECT，1个关系）：根据条件表达式选出来的行
- 投影（PROJECTION，1个关系）：根据属性序列选出来的列
- 连接（JOIN，2个关系）：笛卡尔积后，只留两关系中指定属性值相等的元组，去掉重复列



##### 1.3 关系的完整性约束

数据库的数据完整性是指数据库中数据的**正确性、相容性、一致性**。

**分类**：

- 实体完整性约束：主码的组成不能为空，主属性不能是空值（NULL）
- 参照完整性约束：定义外码和主码之间的引用原则，检验外码为空值（NULL）或已经存在
- 用户定义完整性约束：域完整性约束（针对某一应用环境的完整性约束）



执行插入操作，需要对以上三种都进行检验；

执行删除操作，需要检查是否被引用，一般只需要对被参照关系检查参照完整性约束；

执行更新操作，插入和删除两种情况的综合。



### 2. 关系数据库的规范化理论

不好的关系模式中可能存在的**冗余**和**异常**问题：

- 数据冗余：指同一数据被反复存储的情况
- 更新异常：输入冗余造成的，多个内容更改使操作错误
- 插入异常
- 删除异常



##### 2.1 函数依赖与关键字

函数依赖：在关系中，根据 X 的属性值能决定 Y 的属性值，Y 依赖于 X，记作 X->Y，X 称为决定因素。

分类：

- 完全函数依赖: (X, Y)->Z
- 部分函数依赖: (X, Y)，X->Z
- 传递函数依赖: X->Y,Y->Z



##### 2.2 范式与关系规范化过程

一个低一级范式的关系模式通过模式分解可以转换为若干个高一级范式的关系模式的集合，这种过程叫做**规范化**。



第一范式（1NF）：表中每一列的属性都**不可再分**；

第二范式（2NF）：表中每一列的属性都**不可再分**，且非主属性**完全函数依赖**于主属性；

第三范式（3NF）：表中每一列的属性都**不可再分**，且非主属性**完全函数依赖**于主属性，且每个非主属性都不传递函数依赖于主属性；

第三范式的改进形式（BCNF）



## 三、数据库设计



### 1. 数据库设计概述

##### 数据库的生命周期

数据库**分析与设计**阶段：需求分析、概念设计、逻辑设计、物理设计

数据库**实现与操作**阶段：实现、操作与监督、修改与调整



##### 数据库设计的目标

- 满足应用的功能需求：增删改查
- 良好的数据库性能：高效率存取和空间的节省



##### 数据库设计的内容

- 数据库**结构设计**（静态的）：概念结构设计、逻辑结构设计、物理结构设计
- 数据库**行为设计**（动态的）：功能设计、事务设计、程序设计



##### 数据库设计的方法

- 直观设计法：最原始的设计方法
- 规范设计法：基于第三范式的设计方法
- 计算机辅助设计法：辅助软件工程工具



### 2. 数据库设计的基本步骤

##### 2.1 需求分析

数据库设计的**起点**。需求分析的步骤：

- 确定数据库范围
- **应用过程分析**（的结果是数据库结构设计的重要依据）
- 收集与分析数据
    - 静态结构：数据分类表、数据元素表
    - 动态结构：任务分类表、数据特征操作表
    - 数据约束：数据的安全保密性、数据的完整性、响应时间、数据恢复

- 编写需求分析报告



##### 2.2 概念结构设计

概念模型

- **实体分析法**（自顶向下法）
- 属性综合法（自底向上法）



##### 2.3 逻辑结构设计

目标是将概念模型转换为等价的、且对特定 DBMS 所支持的数据模型的结构。

步骤：

- 模型转换
- 子模式设计
- 编制应用程序设计说明
- 设计评价的任务



##### 2.4 物理设计

任务是确定数据库在存储设备上的**存储结构**及**存取方法**，因 DBMS 的不同还可能包括**建立索引**和**聚集**，以及**物理块大小**、**缓冲区个数和大小**、**数据压缩的选择**。



##### 2.5 数据库实施

- 加载数据：收集、分类、整理、校验、输入等
- 应用程序设计：应用编程
- 数据库试运行：工作人员熟悉并掌握系统，避免误操作



##### 2.6 数据库运行与维护

目的是保证数据库的正常运行，系统维护中最困难的工作是：**数据库重组与重构**。



### 3. 关系数据库设计方法

##### 3.1 关系数据库设计过程与各级模式

